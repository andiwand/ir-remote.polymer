function throwError(a){if(a=a||"Error","undefined"!=typeof Error)throw new Error(a);throw a}function assert(a,b){a||throwError("Assertion failed")}function notImplemented(){throwError("not implemented")}function staticGet(a){return function(){return a}}function dynamicGet(a,b){return function(){return a[b]}}function isObject(a){return"object"==typeof a}function isArray(a){return $.isArray(a)}function isString(a){return"string"==typeof a||a instanceof String}function isBoolean(a){return"boolean"==typeof a||a instanceof Boolean}function isNumberInt(a){return a%1===0}function isNumberFloat(a){return a%1!==0}function isNumber(a){return $.isNumeric(a)}function isInt(a){return isNumber(a)&&isNumberInt(a)}function isFloat(a){return isNumber(a)&&isNumberFloat(a)}function isInt32(a){return isInt(a)&&a>=0&&4294967295>=a}MarginOfError=function(a,b){assert(isNumber(a)),assert(isBoolean(b)),this.__error=a,this.__absolute=b},MarginOfError.prototype.checkAbsolute=function(a,b,c){return c==Number.POSITIVE_INFINITY?!0:a>=b-c&&b+c>=a},MarginOfError.prototype.checkRelative=function(a,b,c){return c==Number.POSITIVE_INFINITY?!0:this.checkAbsolute(a,b,b*c)},MarginOfError.prototype.check=function(a,b){return this.__absolute?this.checkAbsolute(a,b,this.__error):this.checkRelative(a,b,this.__error)};var IR=IR||{};IR.Frame=function(){},IR.Frame.prototype.toString=function(){return JSON.stringify(this.serialize())},IR.Frame.prototype.getProtocol=notImplemented,IR.Frame.prototype.getFrequency=function(){return this.getProtocol().frequency},IR.Frame.prototype.encode=function(a){return this.getProtocol().encode(this,a)},IR.Frame.prototype.decode=function(a,b){return this.getProtocol().decode(a,b)},IR.Frame.serialize=function(a){assert(a instanceof IR.Frame);var b={},c=a.getProtocol();return b.protocol=c.name,b.data=a.serialize(),b},IR.Frame.prototype.serialize=notImplemented,IR.Frame.deserialize=function(a){var b=IR.Protocol.map[a.protocol],c=b.getFrameClass();return c.deserialize(a.data)};var IR=IR||{};IR["default"]={error_settings:{frequency_error:new MarginOfError(.1,!1),time_error:new MarginOfError(.1,!1)}},IR["const"]={error_frequency_key:"frequency_error",error_time_key:"time_error"},IR.__impl=IR.__impl||{station_discovery:notImplemented,station_send:notImplemented,station_receive:notImplemented,station_configure:notImplemented};var IR=IR||{};IR.Protocol=function(a,b){assert(isString(a)),assert(null===b||isInt(b)),this.name=a,this.frequency=b,IR.Protocol.map[a]=this},IR.Protocol.map={},IR.Protocol.prototype.toString=function(){return this.name+" protocol"},IR.Protocol.prototype.getFrameClass=notImplemented,IR.Protocol.prototype.encode=function(a,b){assert(a instanceof this.getFrameClass());var c=new IR.RawFrame(a.getFrequency(),[]),d=new IR.RawHelper(c,b);return this.__encode(a,d,b),c},IR.Protocol.prototype.__encode=notImplemented,IR.Protocol.prototype.decode=function(a,b){assert(a instanceof IR.RawFrame);var c=new IR.RawHelper(a,b);return this.__decode(c,b)},IR.Protocol.prototype.__decode=notImplemented;var IR=IR||{};IR.Station=function(a,b,c){assert(isString(a)),assert(isString(b)),assert(isInt(c)),this.name=a,this.__address=b,this.__port=c},IR.Station.discover=function(a,b,c){assert(isInt(a)),assert(isInt(b)),assert(isInt(c)),IR.__impl.station_discovery(a,b,c)},IR.Station.prototype.send=function(a){assert(a instanceof IR.Frame),IR.__impl.station_send(this,a)},IR.Station.prototype.receive=function(){return IR.__impl.station_receive(this)},IR.Station.prototype.configure=function(a,b,c){assert(isString(a)),assert(isString(b)),assert(isString(c)),IR.__impl.station_configure(this,a,b,c)},IR.Station.prototype.serialize=function(){var a={};return a.name=this.name,a.address=this.__address,a.port=this.__port,a},IR.Station.deserialize=function(a){return new IR.Station(a.name,a.address,a.port)};var IR=IR||{};IR.RawHelper=function(a,b){assert(a instanceof IR.RawFrame),assert(isObject(b)),this.__raw=a,this.__settings=b,this.__pos=0},IR.RawHelper.prototype.size=function(){return this.__raw.__times.length},IR.RawHelper.prototype.position=function(a){return a?(assert(isInt(a)),void(this.__pos=a)):this.__pos},IR.RawHelper.prototype.write=function(a){this.__raw.__times[this.__pos]=a,this.__pos++},IR.RawHelper.prototype.matchFrequency=function(a){var b=this.__settings[IR["const"].error_frequency_key];return b.check(this.__raw.__frequency,a)},IR.RawHelper.prototype.matchTime=function(a){var b=this.__settings[IR["const"].error_time_key],c=this.__raw.__times[this.__pos],d=b.check(c,a);return d&&this.__pos++,d},IR.RawHelper.prototype.match=function(a){assert(isArray(a));for(var b=0;b<a.length;b++)if(this.matchTime(a[b]))return b;return-1};var IR=IR||{};IR.NecFrame=function(a){IR.Frame.call(this,IR.Frame),assert(isInt32(a)),this.__data=a},IR.NecFrame.prototype=Object.create(IR.Frame.prototype),IR.NecFrame.prototype.constructor=IR.NecFrame,IR.NecFrame.prototype.getProtocol=dynamicGet(IR,"NecProtocol"),IR.NecFrame.prototype.serialize=function(){return this.__data},IR.NecFrame.deserialize=function(a){return new IR.NecFrame(a)};var IR=IR||{};IR.RawFrame=function(a,b){IR.Frame.call(this,IR.Frame),assert(isInt(a)),assert(isArray(b)),this.__frequency=a,this.__times=b},IR.RawFrame.prototype=Object.create(IR.Frame.prototype),IR.RawFrame.prototype.constructor=IR.RawFrame,IR.RawFrame.prototype.getProtocol=dynamicGet(IR,"RawProtocol"),IR.RawFrame.prototype.getFrequency=function(){return this.frequency},IR.RawFrame.prototype.serialize=function(){var a={};return a.frequency=this.__frequency,a.times=this.__times,a},IR.RawFrame.deserialize=function(a){return new IR.RawFrame(a.frequency,a.times)};var IR=IR||{};IR.NecProtocol=new IR.Protocol("NEC",38222),$.extend(IR.NecProtocol,{__TIME_INIT_MARK:.009,__TIME_INIT_SPACE:.0045,__TIME_REPEAT_SPACE:.00225,__TIME_BIT_MARK:5625e-7,__TIME_ZERO_SPACE:5625e-7,__TIME_ONE_SPACE:.0016875,__TIME_END_MARK:5625e-7,__TIMES_DEFAULT:67,__TIMES_REPEAT:3,__BITS:32,__REPEAT:4294967295,getFrameClass:dynamicGet(IR,"NecFrame"),__encode:function(a,b,c){if(b.write(this.__TIME_INIT_MARK),nec.__data===this.__REPEAT)b.write(this.__TIME_REPEAT_SPACE);else{b.write(this.__TIME_INIT_SPACE);for(var d=0;d<this.__BITS;d++)b.write(this.__TIME_BIT_MARK),0!==(nec.__data>>d&1)?b.write(this.__TIME_ONE_SPACE):b.write(this.__TIME_ZERO_SPACE)}b.write(this.__TIME_END_MARK)},__decode:function(a,b){var c=0;if(!a.matchFrequency(this.frequency))return null;if(!a.matchTime(this.__TIME_INIT_MARK))return null;if(a.matchTime(this.__TIME_INIT_SPACE))for(var d=0;d<this.__BITS;d++){if(!a.matchTime(this.__TIME_BIT_MARK))return null;if(a.matchTime(this.__TIME_ONE_SPACE))c|=1<<d;else if(!a.matchTime(this.__TIME_ZERO_SPACE))return null}else{if(!a.matchTime(this.__TIME_INIT_SPACE))return null;c=this.__REPEAT}return a.matchTime(this.__TIME_END_MARK)?a.position()!=a.size()?null:new IR.NecFrame(c):null}});var IR=IR||{};IR.RawProtocol=new IR.Protocol("RAW",null),$.extend(IR.RawProtocol,{getFrameClass:dynamicGet(IR,"RawFrame"),encode:function(a,b){return a},decode:function(a,b){return a}});